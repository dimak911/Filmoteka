{"mappings":"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","sources":["src/js/movie-modal.js","src/js/api/fetch-movie.js","src/js/api/api-vars.js","src/js/queue.js","src/js/localstorage.js","src/js/watched.js"],"sourcesContent":["import { getMovies } from './api/fetch-movie';\nimport { ID_URL, BASE_IMG_URL, API_KEY } from './api/api-vars';\nimport { onBtnQueueClick } from './queue';\nimport { onAddToWatchedBtnClick } from './watched';\nimport { scrollFunction } from './scroll-up';\n\nconst refs = {\n  backdrop: document.querySelector('.movie-backdrop'),\n  closeBtn: document.querySelector('button[data-dismiss=\"modal\"]'),\n  cardModal: document.querySelector('ul[data-point=\"galery\"]'),\n  queueBtn: document.querySelector('.to-queue'),\n  imgRef: document.querySelector('.image-container'),\n  contentRef: document.querySelector('.content-markup'),\n  addToWatchedButton: document.querySelector('.to-watched'),\n};\n\nconst {\n  backdrop,\n  closeBtn,\n  cardModal,\n  queueBtn,\n  imgRef,\n  contentRef,\n  addToWatchedButton,\n} = refs;\n\nconst toTopBtn = document.getElementById('myBtn');\n\nfunction addAllEventListenersModal() {\n  closeBtn.addEventListener('click', onCloseBtnClick);\n  window.addEventListener('keydown', onKeydownEscape);\n  backdrop.addEventListener('click', onBackdropClick);\n  queueBtn.addEventListener('click', onBtnQueueClick);\n  addToWatchedButton.addEventListener('click', onAddToWatchedBtnClick);\n}\n\nfunction onCloseBtnClick(e) {\n  e.preventDefault();\n  backdrop.classList.add('is-hidden');\n  scrollFunction();\n  removeAllEventListenersModal();\n}\n\nfunction onKeydownEscape(e) {\n  e.preventDefault();\n  if (e.code !== 'Escape') {\n    return;\n  }\n  backdrop.classList.add('is-hidden');\n  scrollFunction();\n  removeAllEventListenersModal();\n}\n\nfunction onBackdropClick(e) {\n  \n  if (!e.target.classList.contains('backdrop')) {\n    return;\n  }\n  backdrop.classList.add('is-hidden');\n  scrollFunction();\n  removeAllEventListenersModal();\n}\n\nfunction removeAllEventListenersModal() {\n  closeBtn.removeEventListener('click', onCloseBtnClick);\n  window.removeEventListener('keydown', onKeydownEscape);\n  backdrop.removeEventListener('click', onBackdropClick);\n  queueBtn.removeEventListener('click', onBtnQueueClick);\n  addToWatchedButton.removeEventListener('click', onAddToWatchedBtnClick);\n  document.body.classList.toggle('modal-open');\n}\n\ncardModal && cardModal.addEventListener('click', clickOnMovieHandler);\n\nlet movieId;\n\n// клик\nfunction clickOnMovieHandler(e) {\n  e.preventDefault();\n\n  if (e.target.nodeName !== 'IMG') {\n    return;\n  }\n\n  backdrop.classList.remove('is-hidden');\n  document.body.classList.toggle('modal-open');\n  toTopBtn.style.display = 'none';\n\n  movieId = e.target.dataset.id;\n  backdrop.setAttribute('id', movieId);\n\n  fetchById(movieId);\n\n  addAllEventListenersModal();\n\n  whichBtnShow(movieId);\n  whichBtnShowInWatchedFilms(movieId);\n}\n\n//Фетч фильма по ID\nfunction fetchById(movieId) {\n  const idURL = `${ID_URL}${movieId}?api_key=${API_KEY}&language=en-US`;\n \n  getMovies(idURL).then(res => {\n    renderFilmCard(res);\n   \n  });\n}\n\nfunction renderFilmCard(film) {\n  modalFilmCart(film);\n \n}\n\nconst getGenresNames = genres => genres.map(genre => genre.name).join(', ');\n\nfunction modalFilmCart({\n  title,\n  original_title,\n  vote_average,\n  vote_count,\n  popularity,\n  genres,\n  overview,\n  poster_path,\n}) {\n  \n  \n  let imageMarkup = `\n  <img \n    src=\"${BASE_IMG_URL}${poster_path}\"\n      alt=\"${title} movie poster}\" \n      width=\"375\" height=\"478\" \n      class=\"image\"\n      />`;\nif (poster_path === null) {\n    imageMarkup = `\n  <img \n    src=\"https://dummyimage.com/395x574/000/fff.jpg&text=no+poster\"\n      alt=\"${title} movie poster}\" \n      width=\"395\" height=\"574\" \n      class=\"image\"\n      />`;\n  }\n  const markup = `\n  <h2 class=\"title\">${title}</h2>\n  <div class=\"properties\">\n      <div class=\"titles\">\n          <p class=\"property\">Vote / Votes</p>\n          <p class=\"property\">Popularity</p>\n          <p class=\"property\">Original Title</p>\n          <p class=\"property\">Genre</p>\n      </div>\n      <div class=\"values\">\n          <p class=\"value\"><span class=\"first-mark\">${vote_average}</span>&nbsp;/&nbsp;<span class=\"second-mark\">${vote_count}</span></p>\n          <p class=\"value\">${popularity}</p>\n          <p class=\"value\">${original_title}</p>\n          <p class=\"value\">${getGenresNames(genres)}</p>\n          \n      </div>\n  </div>\n  <div class=\"about\">\n      <p class=\"title\">About</p>\n      <div class=\"about-container\">\n          <p class=\"text\">${overview}</p>          \n      </div>\n  </div>\n      `;\n\n  imgRef.innerHTML = imageMarkup;\n  contentRef.innerHTML = markup;\n}\n\nfunction clearModalContent() {\n  imgRef.innerHTML = '';\n  contentRef.innerHTML = '';\n}\n\nfunction whichBtnShow(id) {\n  const localstorage = localStorage.getItem('queue');\n\n  if (localstorage === null) {\n    queueBtn.textContent = 'Add to queue';\n    return;\n  }\n  if (JSON.parse(localstorage.includes(id))) {\n    queueBtn.textContent = 'Remove from queue';\n  } else {\n    queueBtn.textContent = 'Add to queue';\n  }\n}\n\nfunction whichBtnShowInWatchedFilms(id) {\n  const localstorageWatched = localStorage.getItem('watched');\n\n  if (localstorageWatched === null) {\n    addToWatchedButton.textContent = 'Add to watched';\n    return;\n  }\n  if (JSON.parse(localstorageWatched.includes(id))) {\n    addToWatchedButton.textContent = 'Remove from watched';\n  } else {\n    addToWatchedButton.textContent = 'Add to watched';\n  }\n}\n","import axios from 'axios';\n\nexport async function getMovies(url) {\n  try {\n    const response = await axios.get(`${url}`);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  }\n}\n","const API_KEY = '6f3a72a470b06bab99f8d69f54b4e2d3';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst TREND_URL = `${BASE_URL}/trending/movie/week?api_key=${API_KEY}`;\nconst SEARCH_URL = `${BASE_URL}/search/movie?api_key=${API_KEY}`;\nconst ID_URL = `${BASE_URL}/movie/`;\nconst BASE_IMG_URL = 'https://image.tmdb.org/t/p/w500';\n\nexport { API_KEY, BASE_URL, TREND_URL, SEARCH_URL, ID_URL, BASE_IMG_URL };\n","import { getMovies } from './api/fetch-movie';\nimport { API_KEY, BASE_IMG_URL, SEARCH_URL, ID_URL } from './api/api-vars.js';\n// import { renderPagination } from './pagination.js';\nimport { localstorage } from './localstorage.js';\n\nconst queueBtn = document.querySelector('.to-queue');\nconst bg = document.querySelector('.backdrop');\nconst libraryTextContainer = document.querySelector('.library-text');\nconst libraryGallery = document.querySelector('.library-gallery');\nconst libraryQueueBtn = document.querySelector('button[data-action=\"queue\"]');\nlet queueMovieId = localStorage.getItem('queue');\nlet parseQueueMovieId = JSON.parse(queueMovieId);\n\nlibraryQueueBtn && libraryQueueBtn.focus();\nlibraryQueueBtn && onLibraryQueueBtnClick();\n\nfunction inLocalStorage(value) {\n  if (localStorage.getItem('queue') !== null) {\n    if (!JSON.parse(localStorage.getItem('queue').includes(value))) {\n      return false;\n    }\n    return true;\n  }\n  return true;\n}\n\nexport function onBtnQueueClick() {\n  const id = bg.id;\n\n  if (!inLocalStorage(id)) {\n    queueBtn.textContent = 'Remove from queue';\n    localstorage.setFilm('queue', id);\n  } else {\n    queueBtn.textContent = 'Add to queue';\n    localstorage.removeFilm('queue', id);\n  }\n\n  libraryGallery && onLibraryQueueBtnClick();\n  libraryQueueBtn && libraryQueueBtn.focus();\n}\n\nlibraryQueueBtn &&\n  libraryQueueBtn.addEventListener('click', onLibraryQueueBtnClick);\n\nfunction onLibraryQueueBtnClick() {\n  queueMovieId = localStorage.getItem('queue');\n  parseQueueMovieId = JSON.parse(queueMovieId);\n\n  clearGallery();\n\n  if (queueMovieId === null) {\n    getPlugVisible();\n    return;\n  } else if (parseQueueMovieId.length === 0) {\n    getPlugVisible();\n    return;\n  } else if (!libraryTextContainer.classList.contains('visually-hidden')) {\n    getPlugHidden();\n  }\n\n  fetchQueue(queueMovieId);\n}\n\nfunction clearGallery() {\n  libraryGallery.innerHTML = '';\n}\n\nfunction getPlugVisible() {\n  libraryGallery.innerHTML = '';\n\n  libraryTextContainer.classList.remove('visually-hidden');\n}\n\nfunction getPlugHidden() {\n  libraryTextContainer.classList.add('visually-hidden');\n}\n\nfunction fetchQueue(queueMovieId) {\n  const moviesIDInQueue = JSON.parse(queueMovieId);\n\n  moviesIDInQueue.map(movieID => {\n    fetchById(movieID).then(res => {\n      renderMovieCardsLibrary(res);\n    });\n  });\n}\n\nfunction fetchById(movieId) {\n  const idURL = `${ID_URL}${movieId}?api_key=${API_KEY}&language=en-US`;\n  return getMovies(idURL);\n}\n\nfunction renderMovieCardsLibrary(movie) {\n  const movieGalleryMarkup = createLibraryMovieMarkup(movie);\n\n  libraryGallery.insertAdjacentHTML('beforeend', movieGalleryMarkup);\n}\n\nfunction createLibraryMovieMarkup(movie) {\n  const { title, genres, release_date, poster_path, vote_average, id } = movie;\n\n  let year = '';\n  if (typeof release_date !== 'undefined' && release_date.length > 4) {\n    year = release_date.slice(0, 4);\n  }\n\n  const queueGenres = getQueueMovieGenresList(genres);\n\n  return `<li>\n            <a class=\"gallery__link\" href=\"#\">\n              <img class=\"gallery__image\" data-id=\"${id}\" src=\"${BASE_IMG_URL}${poster_path}\" alt=\"${title} movie poster\" loading=\"lazy\">\n\n            <div class=\"info\">\n              <p class=\"info__item\">${title}</p>\n              <div class=\"info-detail\">\n                <p class=\"info-detail__item\">${queueGenres}</p>\n                <p class=\"info-detail__item\">${year} <span class=\"points\">${vote_average}</span></p>\n              </div>\n            </div>\n            </a>\n          </li>`;\n}\n\nfunction getQueueMovieGenresList(genres) {\n  let genresNames = genres.map(genre => genre.name);\n  if (genresNames.length > 3) {\n    genresNames = genresNames.slice(0, 2);\n    genresNames.push('Other');\n  }\n  return genresNames.join(', ');\n}\n","export const localstorage = {\n  loadData(key) {\n    const localStorageData = localStorage.getItem(key);\n    return JSON.parse(localStorageData);\n  },\n\n  saveData(key, value) {\n    const dataToSave = JSON.stringify(value);\n    localStorage.setItem(key, dataToSave);\n  },\n\n  setFilm(key, value) {\n    const currentCollection = this.getMovies(key);\n    currentCollection.push(value);\n    this.saveData(key, currentCollection);\n  },\n\n  removeFilm(key, value) {\n    const films = this.getMovies(key);\n    if (films.includes(value)) {\n      films.splice(films.indexOf(value), 1);\n      this.saveData(key, films);\n    } else return;\n  },\n\n  getMovies(key) {\n    const movies = this.loadData(key);\n    if (!movies) {\n      this.saveData(key, []);\n      return [];\n    } else {\n      return movies;\n    }\n  },\n};\n","import { API_KEY, BASE_IMG_URL, SEARCH_URL, ID_URL } from './api/api-vars.js';\n// import { renderPagination } from './pagination.js';\nimport { getMovies } from './api/fetch-movie';\nimport { localstorage } from './localstorage.js';\n\nconst addToWatchedButton = document.querySelector('.to-watched');\nconst bg = document.querySelector('.backdrop');\nconst libraryTextContainer = document.querySelector('.library-text');\nconst libraryGallery = document.querySelector('.library-gallery');\nconst libraryWatchedBtn = document.querySelector(\n  'button[data-action=\"watched\"]'\n);\n\nfunction inLocalStorage(value) {\n  if (localStorage.getItem('watched') !== null) {\n    if (!JSON.parse(localStorage.getItem('watched').includes(value))) {\n      return false;\n    }\n    return true;\n  }\n  return true;\n}\n\nexport function onAddToWatchedBtnClick() {\n  const id = bg.id;\n\n  if (!inLocalStorage(id)) {\n    addToWatchedButton.textContent = 'Remove from watched';\n    localstorage.setFilm('watched', id);\n  } else {\n    addToWatchedButton.textContent = 'Add to watched';\n    localstorage.removeFilm('watched', id);\n  }\n\n  libraryGallery && onWatchedBtnClick();\n  libraryWatchedBtn && libraryWatchedBtn.focus();\n}\n\nlibraryWatchedBtn &&\n  libraryWatchedBtn.addEventListener('click', onWatchedBtnClick);\n\nlet watchedMovieId;\nlet parseWatchedMovieId;\n\nfunction onWatchedBtnClick() {\n  watchedMovieId = localStorage.getItem('watched');\n  parseWatchedMovieId = JSON.parse(watchedMovieId);\n\n  clearGallery();\n\n  if (watchedMovieId === null) {\n    getPlugVisible();\n    return;\n  } else if (parseWatchedMovieId.length === 0) {\n    getPlugVisible();\n    return;\n  } else if (!libraryTextContainer.classList.contains('visually-hidden')) {\n    getPlugHidden();\n  }\n\n  fetchWatched(watchedMovieId);\n}\n\nfunction clearGallery() {\n  libraryGallery.innerHTML = '';\n}\n\nfunction getPlugVisible() {\n  libraryGallery.innerHTML = '';\n\n  libraryTextContainer.classList.remove('visually-hidden');\n}\n\nfunction getPlugHidden() {\n  libraryTextContainer.classList.add('visually-hidden');\n}\n\nfunction fetchWatched(watchedMovieId) {\n  const moviesIDInWatched = JSON.parse(watchedMovieId);\n\n  moviesIDInWatched.map(movieID => {\n    fetchById(movieID).then(res => {\n      renderMovieCardsLibrary(res);\n    });\n  });\n}\n\nfunction fetchById(movieId) {\n  const idURL = `${ID_URL}${movieId}?api_key=${API_KEY}&language=en-US`;\n  return getMovies(idURL);\n}\n\nfunction renderMovieCardsLibrary(movie) {\n  const movieGalleryMarkup = createLibraryMovieMarkup(movie);\n\n  libraryGallery.insertAdjacentHTML('beforeend', movieGalleryMarkup);\n}\n\nfunction createLibraryMovieMarkup(movie) {\n  const { title, genres, release_date, poster_path, vote_average, id } = movie;\n\n  let year = '';\n  if (typeof release_date !== 'undefined' && release_date.length > 4) {\n    year = release_date.slice(0, 4);\n  }\n\n  const queueGenres = getQueueMovieGenresList(genres);\n\n  return `<li>\n            <a class=\"gallery__link\" href=\"#\">\n              <img class=\"gallery__image\" data-id=\"${id}\" src=\"${BASE_IMG_URL}${poster_path}\" alt=\"${title} movie poster\" loading=\"lazy\">\n\n            <div class=\"info\">\n              <p class=\"info__item\">${title}</p>\n              <div class=\"info-detail\">\n                <p class=\"info-detail__item\">${queueGenres}</p>\n                <p class=\"info-detail__item\">${year} <span class=\"points\">${vote_average}</span></p>\n              </div>\n            </div>\n            </a>\n          </li>`;\n}\n\nfunction getQueueMovieGenresList(genres) {\n  let genresNames = genres.map(genre => genre.name);\n  if (genresNames.length > 3) {\n    genresNames = genresNames.slice(0, 2);\n    genresNames.push('Other');\n  }\n  return genresNames.join(', ');\n}\n"],"names":["$gWoIc","parcelRequire","$4281cb08e8defb2a$var$refs","backdrop","document","querySelector","closeBtn","cardModal","queueBtn","imgRef","contentRef","addToWatchedButton","$4281cb08e8defb2a$var$backdrop","$4281cb08e8defb2a$var$closeBtn","$4281cb08e8defb2a$var$cardModal","$4281cb08e8defb2a$var$queueBtn","$4281cb08e8defb2a$var$imgRef","$4281cb08e8defb2a$var$contentRef","$4281cb08e8defb2a$var$addToWatchedButton","$4281cb08e8defb2a$var$toTopBtn","getElementById","$4281cb08e8defb2a$var$onCloseBtnClick","e","preventDefault","classList","add","$74Aiq","scrollFunction","$4281cb08e8defb2a$var$removeAllEventListenersModal","$4281cb08e8defb2a$var$onKeydownEscape","code","$4281cb08e8defb2a$var$onBackdropClick","target","contains","removeEventListener","window","$edpgF","onBtnQueueClick","$9IiBV","onAddToWatchedBtnClick","body","toggle","$4281cb08e8defb2a$var$movieId","addEventListener","nodeName","remove","style","display","dataset","id","setAttribute","movieId1","idURL","$edYM8","ID_URL","API_KEY","getMovies","then","res","title","original_title","vote_average","vote_count","popularity","genres","overview","poster_path","imageMarkup","BASE_IMG_URL","markup","map","genre","name","join","$4281cb08e8defb2a$var$getGenresNames","innerHTML","$4281cb08e8defb2a$var$modalFilmCart","$4281cb08e8defb2a$var$fetchById","localstorage","localStorage","getItem","textContent","JSON","parse","includes","$4281cb08e8defb2a$var$whichBtnShow","localstorageWatched","$4281cb08e8defb2a$var$whichBtnShowInWatchedFilms","$2shzp","async","$c5553b5f0de3ff37$export$60e1c8f5f122c5ac","url","$parcel$interopDefault","get","data","error","console","$a5b16c4ddc8202a6$export$a9861bd62f48e142","$a5b16c4ddc8202a6$export$3e13cfa1fb75582c","$a5b16c4ddc8202a6$export$48314f791897fe3f","$a5b16c4ddc8202a6$export$b85aa4b53a955004","$a5b16c4ddc8202a6$export$1aee36635db19eb8","$a595e1401ec493e7$var$queueBtn","$a595e1401ec493e7$var$bg","$a595e1401ec493e7$var$libraryTextContainer","$a595e1401ec493e7$var$libraryGallery","$a595e1401ec493e7$var$libraryQueueBtn","$a595e1401ec493e7$var$queueMovieId","$a595e1401ec493e7$var$parseQueueMovieId","$a595e1401ec493e7$export$b055216bf7aaa057","value","$bOFJ0","removeFilm","setFilm","$a595e1401ec493e7$var$onLibraryQueueBtnClick","focus","queueMovieId1","length","movieID","movieId","$a595e1401ec493e7$var$fetchById","movie","movieGalleryMarkup","release_date","year","slice","queueGenres","genresNames","push","$a595e1401ec493e7$var$getQueueMovieGenresList","$a595e1401ec493e7$var$createLibraryMovieMarkup","insertAdjacentHTML","$a595e1401ec493e7$var$renderMovieCardsLibrary","$a595e1401ec493e7$var$getPlugVisible","$89a4baeedb6cdec9$export$bc8378d5b6bedce5","loadData","key","localStorageData","saveData","dataToSave","stringify","setItem","currentCollection","this","films","splice","indexOf","movies","$7126a8cfa5cf9b17$var$addToWatchedButton","$7126a8cfa5cf9b17$var$bg","$7126a8cfa5cf9b17$var$libraryTextContainer","$7126a8cfa5cf9b17$var$libraryGallery","$7126a8cfa5cf9b17$var$libraryWatchedBtn","$7126a8cfa5cf9b17$export$ff174b1cb90714bc","$7126a8cfa5cf9b17$var$onWatchedBtnClick","$7126a8cfa5cf9b17$var$watchedMovieId","$7126a8cfa5cf9b17$var$parseWatchedMovieId","watchedMovieId1","$7126a8cfa5cf9b17$var$fetchById","$7126a8cfa5cf9b17$var$getQueueMovieGenresList","$7126a8cfa5cf9b17$var$createLibraryMovieMarkup","$7126a8cfa5cf9b17$var$renderMovieCardsLibrary","$7126a8cfa5cf9b17$var$getPlugVisible"],"version":3,"file":"my-library.7d362e40.js.map"}